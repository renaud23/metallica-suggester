(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{126:function(module,__webpack_exports__,__webpack_require__){"use strict";var actions_namespaceObject={};__webpack_require__.r(actions_namespaceObject),__webpack_require__.d(actions_namespaceObject,"ON_INIT",(function(){return ON_INIT})),__webpack_require__.d(actions_namespaceObject,"onInit",(function(){return onInit})),__webpack_require__.d(actions_namespaceObject,"ON_CHANGE_SEARCH",(function(){return ON_CHANGE_SEARCH})),__webpack_require__.d(actions_namespaceObject,"onChangeSearch",(function(){return onChangeSearch})),__webpack_require__.d(actions_namespaceObject,"ON_UPDATE_OPTIONS",(function(){return ON_UPDATE_OPTIONS})),__webpack_require__.d(actions_namespaceObject,"onUpdateOptions",(function(){return onUpdateOptions})),__webpack_require__.d(actions_namespaceObject,"ON_FOCUS",(function(){return ON_FOCUS})),__webpack_require__.d(actions_namespaceObject,"onFocus",(function(){return actions_onFocus})),__webpack_require__.d(actions_namespaceObject,"ON_BLUR",(function(){return ON_BLUR})),__webpack_require__.d(actions_namespaceObject,"onBlur",(function(){return actions_onBlur})),__webpack_require__.d(actions_namespaceObject,"ON_CLICK_OPTION",(function(){return ON_CLICK_OPTION})),__webpack_require__.d(actions_namespaceObject,"onClickOption",(function(){return onClickOption})),__webpack_require__.d(actions_namespaceObject,"ON_KEY_DOWN",(function(){return ON_KEY_DOWN})),__webpack_require__.d(actions_namespaceObject,"onKeyDown",(function(){return actions_onKeyDown}));var slicedToArray=__webpack_require__(20),regenerator=__webpack_require__(10),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(24),react=__webpack_require__(0),react_default=__webpack_require__.n(react),ON_INIT="lunatic-suggester/on-init",onInit=function onInit(id){return{type:ON_INIT,payload:{id:id}}},ON_CHANGE_SEARCH="lunatic-suggester/on-change-search",onChangeSearch=function onChangeSearch(search){return{type:ON_CHANGE_SEARCH,payload:{search:search}}},ON_UPDATE_OPTIONS="lunatic-suggester/on-update-options",onUpdateOptions=function onUpdateOptions(options,search){return{type:ON_UPDATE_OPTIONS,payload:{options:options,search:search}}},ON_FOCUS="lunatic-suggester/on-focus",actions_onFocus=function onFocus(){return{type:ON_FOCUS}},ON_BLUR="lunatic-suggester/on-blur",actions_onBlur=function onBlur(){return{type:ON_BLUR}},ON_CLICK_OPTION="lunatic-suggester/on-click-option",onClickOption=function onClickOption(index){return{type:ON_CLICK_OPTION,payload:{index:index}}},ON_KEY_DOWN="lunatic-suggester/on-key-down",actions_onKeyDown=function onKeyDown(key){return{type:ON_KEY_DOWN,payload:{key:key}}},objectSpread2=__webpack_require__(6);var reduce_on_change_search=function reduce(state,action){var search=action.payload.search;return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{search:search,selectedIndex:void 0})};var reduce_on_update_options=function reduce_on_update_options_reduce(state,action){var payload=action.payload,options=payload.options,old=payload.search;return state.search===old?Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{options:options}):Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{options:[]})};var reduce_on_focus=function reduce_on_focus_reduce(state){return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{focused:!0,expended:!0,displayLabel:!1})};var reduce_on_blur=function reduce_on_blur_reduce(state){return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{focused:!1,expended:!1,displayLabel:!0})};var reduce_on_click_option=function reduce_on_click_option_reduce(state,action){var selectedIndex=action.payload.index;return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{selectedIndex:selectedIndex})},toConsumableArray=__webpack_require__(46),CALLBACKS={};function getSignature(event){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.entries(options).reduce((function(a,_ref){var _ref2=Object(slicedToArray.a)(_ref,2),k=_ref2[0],v=_ref2[1];return"".concat(a,"-").concat(k,"-").concat(v)}),event)}function mount(event,callback,options){var signature=getSignature(event,options);if(signature in CALLBACKS)CALLBACKS[signature]=Object(objectSpread2.a)(Object(objectSpread2.a)({},CALLBACKS[signature]),{},{callbacks:[].concat(Object(toConsumableArray.a)(CALLBACKS[signature].callbacks),[callback])});else{var listener=function createListener(event,options){var signature=getSignature(event,options),listener=function listener(e){signature in CALLBACKS&&CALLBACKS[signature].callbacks.forEach((function(c){c(e)}))};return document.addEventListener(event,listener,options),listener}(event,options);CALLBACKS[signature]={listener:listener,callbacks:[callback]}}}var use_document_add_event_listener=function useDocumentAddEventListener(event,callback,options){Object(react.useEffect)((function(){return mount(event,callback,options),function(){!function unmount(event,callback,options){var signature=getSignature(event,options);if(signature in CALLBACKS){var _CALLBACKS$signature=CALLBACKS[signature],listener=_CALLBACKS$signature.listener,index=_CALLBACKS$signature.callbacks.indexOf(callback);CALLBACKS[signature].callbacks.splice(index,1),0===CALLBACKS[signature].callbacks.length&&(delete CALLBACKS[signature],document.removeEventListener(event,listener))}}(event,callback,options)}}),[event,callback,options])},binded_keys={ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Home:"Home",End:"End",Enter:"Enter",Escape:"Escape",Tab:"Tab"};var reduce_on_key_down=function reduce_on_key_down_reduce(state,action){switch(action.payload.key){case binded_keys.ArrowDown:return function reduceArrowDown(state){var options=state.options,prec=state.selectedIndex;if(options.length){var selectedIndex=Math.min(prec+1||0,options.length-1);return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{selectedIndex:selectedIndex,expended:!0})}return state}(state);case binded_keys.ArrowUp:return function reduceArrowUp(state){var prec=state.selectedIndex;if(state.options.length){var selectedIndex=Math.max(prec-1||0,0);return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{selectedIndex:selectedIndex,expended:!0})}return state}(state);case binded_keys.Home:return function reduceHome(state){return state.options.length?Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{selectedIndex:0,expended:!0}):state}(state);case binded_keys.End:return function reduceEnd(state){var options=state.options;return options.length?Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{selectedIndex:options.length-1,expended:!0}):state}(state);case binded_keys.Tab:return function reduceTab(state){return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{focused:!1,expended:!1})}(state);case binded_keys.Enter:return function reduceEnter(state){var expended=state.expended;return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{expended:!expended})}(state);case binded_keys.Escape:return function reduceEscape(state){return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{expended:!1})}(state);default:return state}};var reduce_on_init=function reduce_on_init_reduce(state,action){var id=action.payload.id;return Object(objectSpread2.a)(Object(objectSpread2.a)({},state),{},{id:id||"lunatic-suggester-".concat((new Date).getTime())})};var reducer=function reducer_reduce(state,action){switch(action.type){case ON_CHANGE_SEARCH:return reduce_on_change_search(state,action);case ON_UPDATE_OPTIONS:return reduce_on_update_options(state,action);case ON_FOCUS:return reduce_on_focus(state,action);case ON_BLUR:return reduce_on_blur(state,action);case ON_CLICK_OPTION:return reduce_on_click_option(state,action);case ON_KEY_DOWN:return reduce_on_key_down(state,action);case ON_INIT:return reduce_on_init(state,action);default:return state}},suggester_context=react_default.a.createContext([void 0,void 0]),intial_state={id:"",search:"",options:[],focused:!1,expended:!1,displayLabel:!0,selectedIndex:void 0};var classnames=__webpack_require__(56),classnames_default=__webpack_require__.n(classnames),jsx_runtime=__webpack_require__(5);function SuggesterContainer(_ref){var children=_ref.children,id=_ref.id,className=_ref.className,focused=_ref.focused,onFocus=_ref.onFocus,onBlur=_ref.onBlur,onKeyDown=_ref.onKeyDown,ref=Object(react.useRef)(),onClick=Object(react.useCallback)((function(e){ref.current.contains(e.target)||onBlur()}),[ref,onBlur]);return use_document_add_event_listener("mousedown",onClick),Object(jsx_runtime.jsx)("div",{id:id,className:classnames_default()("lunatic-suggester",className,{focused:focused}),tabIndex:"-1",onFocus:onFocus,onKeyDown:onKeyDown,ref:ref,children:Object(jsx_runtime.jsx)("div",{className:classnames_default()("lunatic-suggester-container",{focused:focused}),children:children})})}SuggesterContainer.__docgenInfo={description:"",methods:[],displayName:"SuggesterContainer"};var suggester_container=SuggesterContainer;function DefaultLabelRenderer(_ref){var option=_ref.option,placeholder=_ref.placeholder,content=function getContent(option,search){return option?option.id:search&&search.trim().length?search:void 0}(option,_ref.search);return content?Object(jsx_runtime.jsx)("span",{className:"selection",children:content}):Object(jsx_runtime.jsx)("span",{className:"placeholder",children:placeholder})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\suggester-container.js"]={name:"SuggesterContainer",docgenInfo:SuggesterContainer.__docgenInfo,path:"src\\suggester\\components\\suggester-container.js"}),DefaultLabelRenderer.__docgenInfo={description:"",methods:[],displayName:"DefaultLabelRenderer",props:{option:{type:{name:"shape",value:{id:{name:"union",value:[{name:"string"},{name:"number"}],required:!0}}},required:!1,description:""},placeholder:{type:{name:"string"},required:!1,description:""},search:{type:{name:"string"},required:!1,description:""}}};var defaul_label_renderer=DefaultLabelRenderer;function Label(_ref){var _ref$labelRenderer=_ref.labelRenderer,Renderer=void 0===_ref$labelRenderer?defaul_label_renderer:_ref$labelRenderer,placeholder=_ref.placeholder,_useContext=Object(react.useContext)(suggester_context),state=Object(slicedToArray.a)(_useContext,1)[0],displayLabel=state.displayLabel,expended=state.expended,selectedIndex=state.selectedIndex,options=state.options,search=state.search,displayed=displayLabel||!expended,option=void 0!==selectedIndex?options[selectedIndex]:void 0;return Object(jsx_runtime.jsx)("div",{className:classnames_default()("lunatic-suggester-selected",{displayed:displayed}),onClick:function onClick(){return console.log("ici")},tabIndex:"-1",children:Object(jsx_runtime.jsx)(Renderer,{option:option,placeholder:placeholder,search:search})})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\selection\\defaul-label-renderer.js"]={name:"DefaultLabelRenderer",docgenInfo:DefaultLabelRenderer.__docgenInfo,path:"src\\suggester\\components\\selection\\defaul-label-renderer.js"}),Label.__docgenInfo={description:"",methods:[],displayName:"Label",props:{labelRenderer:{defaultValue:{value:"DefaultLabelRenderer",computed:!0},required:!1}}};var selection_label=Label;function Selection(_ref,inputEl){var labelRenderer=_ref.labelRenderer,placeholder=_ref.placeholder,labelledBy=_ref.labelledBy,_useContext=Object(react.useContext)(suggester_context),_useContext2=Object(slicedToArray.a)(_useContext,2),state=_useContext2[0],dispatch=_useContext2[1],search=state.search,expended=state.expended,id=state.id;return Object(jsx_runtime.jsxs)("div",{className:"lunatic-suggester-selection",children:[Object(jsx_runtime.jsx)("input",{ref:inputEl,id:"".concat(id,"-input"),tabIndex:"0",className:"lunatic-suggester-input",type:"text",onChange:function onChange(e){dispatch(actions_namespaceObject.onChangeSearch(e.target.value))},value:search,role:"combobox","aria-expanded":expended,"aria-autocomplete":"list","aria-controls":"".concat(id,"-list"),"aria-labelledby":labelledBy,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:"false",placeholder:placeholder}),Object(jsx_runtime.jsx)(selection_label,{labelRenderer:labelRenderer,placeholder:placeholder})]})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\selection\\label.js"]={name:"Label",docgenInfo:Label.__docgenInfo,path:"src\\suggester\\components\\selection\\label.js"});var selection=react_default.a.forwardRef(Selection);function PanelContainer(_ref){var children=_ref.children,focused=_ref.focused,id=_ref.id;return Object(jsx_runtime.jsx)("ul",{id:id,tabIndex:"-1",className:classnames_default()("lunatic-suggester-panel",{focused:focused}),role:"listbox",children:children})}PanelContainer.__docgenInfo={description:"",methods:[],displayName:"PanelContainer"};var panel_container=PanelContainer;function getMin(rect){return rect.top}function getMax(rect){return rect.top+rect.height}function OptionContainer(_ref){var children=_ref.children,index=_ref.index,ref=Object(react.useRef)(),_useContext=Object(react.useContext)(suggester_context),_useContext2=Object(slicedToArray.a)(_useContext,2),state=_useContext2[0],dispatch=_useContext2[1],selectedIndex=state.selectedIndex,selected=index===selectedIndex;return Object(react.useEffect)((function(){var current=ref.current;current&&selected&&(function isVisible(optionRect,parentRect){var min=Math.min(getMin(optionRect),getMin(parentRect));return Math.max(getMax(optionRect),getMax(parentRect))-min<optionRect.height+parentRect.height}(current.getBoundingClientRect(),current.parentNode.getBoundingClientRect())||current.scrollIntoView())}),[ref,selected]),Object(jsx_runtime.jsx)("li",{className:classnames_default()("lunatic-suggester-option",{selected:selected}),role:"option","aria-selected":selected,onClick:function onClick(e){e.stopPropagation(),e.preventDefault(),dispatch(actions_namespaceObject.onClickOption(index))},ref:ref,children:children})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\panel\\panel-container.js"]={name:"PanelContainer",docgenInfo:PanelContainer.__docgenInfo,path:"src\\suggester\\components\\panel\\panel-container.js"}),OptionContainer.__docgenInfo={description:"",methods:[],displayName:"OptionContainer"};var option_container=OptionContainer;function Panel(_ref){var OptionRender=_ref.optionRenderer,_useContext=Object(react.useContext)(suggester_context),state=Object(slicedToArray.a)(_useContext,1)[0],options=state.options,focused=state.focused,selectedIndex=state.selectedIndex,expended=state.expended,id=state.id,content=function panel_getContent(options,OptionRender,selectedIndex,expended){if(expended)return options.map((function(option,index){var id=option.id,selected=selectedIndex===index;return Object(jsx_runtime.jsx)(option_container,{index:index,children:Object(jsx_runtime.jsx)(OptionRender,{option:option,selected:selected})},id)}))}(options,OptionRender,selectedIndex,expended);return Object(jsx_runtime.jsx)(panel_container,{focused:focused,id:"".concat(id,"-list"),children:content})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\panel\\option-container.js"]={name:"OptionContainer",docgenInfo:OptionContainer.__docgenInfo,path:"src\\suggester\\components\\panel\\option-container.js"}),Panel.__docgenInfo={description:"",methods:[],displayName:"Panel"};var panel=Panel;function DefaultOptionRenderer(_ref){var option=_ref.option,selected=_ref.selected,id=option.id,label=option.label;return Object(jsx_runtime.jsx)("div",{className:classnames_default()("lunatic-suggester-default-option",{selected:selected}),children:label||id})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\panel\\panel.js"]={name:"Panel",docgenInfo:Panel.__docgenInfo,path:"src\\suggester\\components\\panel\\panel.js"}),DefaultOptionRenderer.__docgenInfo={description:"",methods:[],displayName:"DefaultOptionRenderer"};var default_option_renderer=DefaultOptionRenderer;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\panel\\default-option-renderer.js"]={name:"DefaultOptionRenderer",docgenInfo:DefaultOptionRenderer.__docgenInfo,path:"src\\suggester\\components\\panel\\default-option-renderer.js"});var create_on_keydown_callback=function create(dispatch){return function(e){var key=e.key;switch(key){case binded_keys.Tab:e.stopPropagation(),dispatch(actions_namespaceObject.onKeyDown(key));break;case binded_keys.ArrowDown:case binded_keys.ArrowUp:case binded_keys.Home:case binded_keys.End:case binded_keys.Enter:case binded_keys.Escape:e.preventDefault(),e.stopPropagation(),dispatch(actions_namespaceObject.onKeyDown(key))}}};__webpack_require__(878);function Suggester(_ref){var className=_ref.className,placeholder=_ref.placeholder,labelledBy=_ref.labelledBy,optionRenderer=_ref.optionRenderer,labelRenderer=_ref.labelRenderer,inputEl=Object(react.useRef)(),_useContext=Object(react.useContext)(suggester_context),_useContext2=Object(slicedToArray.a)(_useContext,2),state=_useContext2[0],dispatch=_useContext2[1],focused=state.focused,id=state.id,onFocus=Object(react.useCallback)((function(){inputEl.current.focus(),dispatch(actions_namespaceObject.onFocus())}),[dispatch]),onBlur=Object(react.useCallback)((function(){focused&&dispatch(actions_namespaceObject.onBlur())}),[dispatch,focused]),onKeyDown=create_on_keydown_callback(dispatch);return Object(jsx_runtime.jsxs)(suggester_container,{id:id,className:className,focused:focused,onFocus:onFocus,onBlur:onBlur,onKeyDown:onKeyDown,children:[Object(jsx_runtime.jsx)(selection,{labelRenderer:labelRenderer,placeholder:placeholder,labelledBy:labelledBy,ref:inputEl}),Object(jsx_runtime.jsx)(panel,{optionRenderer:optionRenderer})]})}Suggester.__docgenInfo={description:"",methods:[],displayName:"Suggester"};var components_suggester=Suggester;function LunaticSuggester(_ref){var id=_ref.id,className=_ref.className,storeName=_ref.storeName,version=_ref.version,labelledBy=_ref.labelledBy,placeholder=_ref.placeholder,optionRenderer=_ref.optionRenderer,onSelect=_ref.onSelect,onChange=_ref.onChange,searching=_ref.searching,labelRenderer=_ref.labelRenderer,_useReducer=Object(react.useReducer)(reducer,intial_state),_useReducer2=Object(slicedToArray.a)(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1],search=state.search,selectedIndex=state.selectedIndex,options=state.options;return Object(react.useEffect)((function(){function _doIt(){return(_doIt=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(){var _yield$searching,results,old;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,searching(search);case 2:_yield$searching=_context.sent,results=_yield$searching.results,old=_yield$searching.search,dispatch(actions_namespaceObject.onUpdateOptions(results,old)),onChange(results,old);case 7:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}!function doIt(){return _doIt.apply(this,arguments)}()}),[search,onChange,searching]),Object(react.useEffect)((function(){void 0!==selectedIndex&&onSelect(options[selectedIndex],selectedIndex)}),[selectedIndex,onSelect,options]),Object(react.useEffect)((function(){dispatch(actions_namespaceObject.onInit(id))}),[id]),Object(jsx_runtime.jsx)(suggester_context.Provider,{value:[state,dispatch],children:Object(jsx_runtime.jsx)(components_suggester,{className:className,placeholder:placeholder,storeName:storeName,version:version,labelledBy:labelledBy,optionRenderer:optionRenderer,labelRenderer:labelRenderer})})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\components\\suggester.js"]={name:"Suggester",docgenInfo:Suggester.__docgenInfo,path:"src\\suggester\\components\\suggester.js"}),LunaticSuggester.defaultProps={id:void 0,className:void 0,labelledBy:void 0,placeholder:"Veuillez...",optionRenderer:default_option_renderer,labelRenderer:defaul_label_renderer,language:"French",onSelect:function onSelect(){return null},onChange:function onChange(){return null}},LunaticSuggester.__docgenInfo={description:"",methods:[],displayName:"LunaticSuggester",props:{id:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:""},className:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:""},labelledBy:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:""},placeholder:{defaultValue:{value:"'Veuillez...'",computed:!1},type:{name:"string"},required:!1,description:""},optionRenderer:{defaultValue:{value:"DefaultOptionRenderer",computed:!0},type:{name:"func"},required:!1,description:""},labelRenderer:{defaultValue:{value:"DefaultLabelRenderer",computed:!0},type:{name:"func"},required:!1,description:""},language:{defaultValue:{value:"'French'",computed:!1},required:!1},onSelect:{defaultValue:{value:"() => null",computed:!1},type:{name:"func"},required:!1,description:""},onChange:{defaultValue:{value:"() => null",computed:!1},type:{name:"func"},required:!1,description:""}}};var suggester_suggester=LunaticSuggester;function Worker_fn(){return new Worker(__webpack_require__.p+"searching.worker.f4be25cc.iframe.bundle.worker.js")}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester\\suggester.js"]={name:"LunaticSuggester",docgenInfo:LunaticSuggester.__docgenInfo,path:"src\\suggester\\suggester.js"});var defineProperty=__webpack_require__(65),commons_idb=__webpack_require__(27),STORES={};function _getDb(){return(_getDb=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(name,version){var store;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(name in STORES)){_context.next=2;break}return _context.abrupt("return",STORES[name]);case 2:return _context.prev=2,_context.next=5,Object(commons_idb.f)(name,version);case 5:return store=_context.sent,STORES[name]=store,_context.abrupt("return",store);case 10:throw _context.prev=10,_context.t0=_context.catch(2),new Error("Can't open store ".concat(name," ").concat(version));case 13:case"end":return _context.stop()}}),_callee,null,[[2,10]])})))).apply(this,arguments)}var get_db=function getDb(_x,_x2){return _getDb.apply(this,arguments)};var search_in_index=function search_in_index_search(token,index){var range=IDBKeyRange.bound(token,"".concat(token).concat(commons_idb.b.MAX_STRING));return new Promise((function(resolve,reject){try{index.getAll(range).onsuccess=function(req){var results=req.target.result;resolve(results)}}catch(e){reject(e)}}))},src=__webpack_require__(244),src_default=__webpack_require__.n(src),commons_tokenizer=__webpack_require__(141);function toArray(tokens){return Array.isArray(tokens)?tokens:[tokens]}var query_parser_tokenized=function query_parser_tokenized_parser(query){var language=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"English",reg=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/[\w]+/,pattern={tokens:reg},_tokenizer$input$toke=src_default()().input(query).tokens(pattern).resolve(),tokens=_tokenizer$input$toke.tokens;return Object(commons_tokenizer.c)(Object(commons_tokenizer.b)(toArray(tokens)),language)};var query_parser_soft=function query_parser_soft_parser(string){return[Object(commons_tokenizer.d)(string,"-")]},PARSERS={};function _resolve(){return(_resolve=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(db,name){var info,queryParser,type,params,language,pattern;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(name in PARSERS)){_context.next=2;break}return _context.abrupt("return",PARSERS[name]);case 2:return _context.prev=2,_context.next=5,Object(commons_idb.d)(db,commons_idb.b.STORE_INFO_NAME,name);case 5:info=_context.sent,queryParser=info.queryParser,type=queryParser.type,_context.t0=type,_context.next="tokenized"===_context.t0?11:"soft"===_context.t0?15:17;break;case 11:return PARSERS[name]=query_parser_tokenized,params=queryParser.params,language=params.language,pattern=params.pattern,_context.abrupt("return",(function(query){return query_parser_tokenized(query,language,pattern)}));case 15:return PARSERS[name]=query_parser_soft,_context.abrupt("return",query_parser_soft);case 17:throw new Error("Unknow parser type ".concat(type));case 18:_context.next=23;break;case 20:throw _context.prev=20,_context.t1=_context.catch(2),new Error(_context.t1);case 23:case"end":return _context.stop()}}),_callee,null,[[2,20]])})))).apply(this,arguments)}var resolve_query_parser=function resolve_query_parser_resolve(_x,_x2){return _resolve.apply(this,arguments)},damerau_levenshtein=__webpack_require__(486);function appendBestSimilarity(results){return Object.entries(results).reduce((function(a,entry){var _entry=Object(slicedToArray.a)(entry,2),token=_entry[0],withSimilarity=_entry[1].map((function(suggestion){var similarity=function findBestSimilarity(tokens,token){return tokens.reduce((function(max,t){var similarity=damerau_levenshtein(t,token).similarity;return Math.max(max,similarity)}),0)}(suggestion.tokens,token);return Object(objectSpread2.a)(Object(objectSpread2.a)({},suggestion),{},{similarity:similarity})}));return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},token,withSimilarity))}),{})}function computeScore(e){var similarities=e.similarities;return e.count*similarities.reduce((function(c,s){return c*s}),1)}var compute_score=function compute(results){return function finalize(withScore){var max=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return withScore.sort((function(a,b){return a.score>b.score?-1:a.score<b.score?1:0})).slice(0,max)}(function appendScore(withCount){return Object.values(withCount).map((function(e){return Object(objectSpread2.a)(Object(objectSpread2.a)({},e),{},{score:computeScore(e)})}))}(function appendCount(withSim){var idWidthCount={};return Object.values(withSim).forEach((function(suggestions){suggestions.forEach((function(e){var id=e.id,similarity=e.similarity,suggestion=e.suggestion;if(id in idWidthCount){var _idWidthCount$id=idWidthCount[id],count=_idWidthCount$id.count,similarities=_idWidthCount$id.similarities;idWidthCount[id]={suggestion:suggestion,count:count+1,similarities:[].concat(Object(toConsumableArray.a)(similarities),[similarity])}}else idWidthCount[id]={suggestion:suggestion,count:1,similarities:[similarity]}}))})),idWidthCount}(appendBestSimilarity(results))))};function prepare(response){return response.map((function(_ref){return _ref.suggestion}))}function searchTokens(_x,_x2){return _searchTokens.apply(this,arguments)}function _searchTokens(){return(_searchTokens=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(tokens,index){var results;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Promise.all(tokens.map((function(token){return search_in_index(token,index)})));case 2:return results=_context.sent,_context.abrupt("return",results.reduce((function(a,step,i){return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},tokens[i],step))}),{}));case 4:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}function isValideSearch(search){return!("string"!=typeof search||!search.trim().length)}function _searching(){return(_searching=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee2(search,name,version){var max,db,parser,transaction,store,index,tokens,tokensSuggestions,resultat;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(max=30,_context2.prev=1,!isValideSearch(search)){_context2.next=20;break}return _context2.next=5,get_db(name,version);case 5:return db=_context2.sent,_context2.next=8,resolve_query_parser(db,name);case 8:return parser=_context2.sent,transaction=db.transaction(commons_idb.b.STORE_DATA_NAME,"readonly"),store=transaction.objectStore(commons_idb.b.STORE_DATA_NAME),index=store.index(commons_idb.b.STORE_INDEX_NAME),tokens=parser(search),_context2.next=15,searchTokens(tokens,index);case 15:if(tokensSuggestions=_context2.sent,resultat=compute_score(tokensSuggestions),!(max&&max<resultat.length)){_context2.next=19;break}return _context2.abrupt("return",prepare(resultat.slice(0,max)));case 19:return _context2.abrupt("return",{results:prepare(resultat),search:search});case 20:return _context2.abrupt("return",{results:[],search:search});case 23:throw _context2.prev=23,_context2.t0=_context2.catch(1),_context2.t0;case 26:case"end":return _context2.stop()}}),_callee2,null,[[1,23]])})))).apply(this,arguments)}var src_searching_searching=function searching_searching(_x3,_x4,_x5){return _searching.apply(this,arguments)},WORKER=void 0;var searching_task=function searching_task_create(searh,name,version){return function isWorkerCompatible(){return!!window.Worker}()?new Promise((function(resolve){WORKER&&WORKER.terminate(),(WORKER=new Worker_fn).postMessage({searh:searh,name:name,version:version}),WORKER.addEventListener("message",(function(e){var data=e.data;resolve(data)}))})):Promise.resolve(src_searching_searching(searh,name,version))};function CheckStore(_ref){var storeName=_ref.storeName,version=_ref.version,setStore=_ref.setStore,children=_ref.children,_useState=Object(react.useState)(0),_useState2=Object(slicedToArray.a)(_useState,2),ready=_useState2[0],setReady=_useState2[1];return Object(react.useEffect)((function(){function _init(){return(_init=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(){var db,info;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,Object(commons_idb.f)(storeName,version);case 3:return db=_context.sent,_context.next=6,Object(commons_idb.d)(db,commons_idb.b.STORE_INFO_NAME,storeName);case 6:info=_context.sent,db&&info&&(setReady(200),setStore(info)),_context.next=13;break;case 10:_context.prev=10,_context.t0=_context.catch(0),setReady(400);case 13:case"end":return _context.stop()}}),_callee,null,[[0,10]])})))).apply(this,arguments)}!function init(){return _init.apply(this,arguments)}()}),[storeName,version,setStore]),0===ready?Object(jsx_runtime.jsxs)("div",{className:"lunatic-suggester-in-progress",children:["Le store ",storeName," est en cour de chargement."]}):200===ready?children:Object(jsx_runtime.jsxs)("div",{className:"lunatic-suggester-unvailable",children:["Le store ",storeName," n'est pas disponible."]})}CheckStore.__docgenInfo={description:"",methods:[],displayName:"CheckStore"};var check_store=CheckStore;function SuggesterIDB(_ref2){var storeName=_ref2.storeName,version=_ref2.version,id=_ref2.id,className=_ref2.className,labelledBy=_ref2.labelledBy,optionRenderer=_ref2.optionRenderer,labelRenderer=_ref2.labelRenderer,onSelect=_ref2.onSelect,onChange=_ref2.onChange,_useState=Object(react.useState)(void 0),_useState2=Object(slicedToArray.a)(_useState,2),store=_useState2[0],setStore=_useState2[1],cally=Object(react.useMemo)((function(){return store?function createSearching(storeName,version,language){return function(){var _ref=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(search){return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",searching_task(search,storeName,version,language));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()}(storeName,version):function(){return[]}}),[storeName,version,store]);return Object(jsx_runtime.jsx)(check_store,{storeName:storeName,version:version,setStore:setStore,children:Object(jsx_runtime.jsx)(suggester_suggester,{id:id,className:className,labelledBy:labelledBy,optionRenderer:optionRenderer,labelRenderer:labelRenderer,onSelect:onSelect,onChange:onChange,searching:cally})})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester-idb\\check-store.js"]={name:"CheckStore",docgenInfo:CheckStore.__docgenInfo,path:"src\\suggester-idb\\check-store.js"}),SuggesterIDB.__docgenInfo={description:"",methods:[],displayName:"SuggesterIDB",props:{storeName:{type:{name:"string"},required:!0,description:""},version:{type:{name:"string"},required:!0,description:""},id:{type:{name:"string"},required:!1,description:""},className:{type:{name:"string"},required:!1,description:""},labelledBy:{type:{name:"string"},required:!1,description:""},optionRenderer:{type:{name:"func"},required:!1,description:""},labelRenderer:{type:{name:"func"},required:!1,description:""},onSelect:{type:{name:"func"},required:!1,description:""},onChange:{type:{name:"func"},required:!1,description:""}}};__webpack_exports__.a=SuggesterIDB;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\suggester-idb\\index.js"]={name:"SuggesterIDB",docgenInfo:SuggesterIDB.__docgenInfo,path:"src\\suggester-idb\\index.js"})},141:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return create_tokenizer})),__webpack_require__.d(__webpack_exports__,"d",(function(){return prepare_string_indexation})),__webpack_require__.d(__webpack_exports__,"c",(function(){return filter_stemmer})),__webpack_require__.d(__webpack_exports__,"b",(function(){return filter_length}));var Snowball=__webpack_require__(485),Snowball_default=__webpack_require__.n(Snowball),STEMMERS={};var get_stemmer=function getStemmer(){var language=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"English";if(!(language in STEMMERS)){var stemmer=new Snowball_default.a(language);STEMMERS[language]=function(token){return stemmer.setCurrent(token),stemmer.stem(),stemmer.getCurrent()}}return STEMMERS[language]},defineProperty=__webpack_require__(65),objectSpread2=__webpack_require__(6),toConsumableArray=__webpack_require__(46),slicedToArray=__webpack_require__(20),src=__webpack_require__(244),src_default=__webpack_require__.n(src),remove_accents=__webpack_require__(245),remove_accents_default=__webpack_require__.n(remove_accents);var prepare_string_indexation=function prepare(){var token=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",replacement=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"string"==typeof token?remove_accents_default()(token.toLowerCase()).replace(/[- ']/g,replacement):token};var soft_tokenizer=function softTokenizer(string){return[prepare_string_indexation(string,"-")]},stop_words=["alors","au","aucuns","aussi","autre","avant","avec","avoir","bon","car","ce","cela","ces","ceux","chaque","ci","comme","comment","dans","des","du","dedans","dehors","depuis","devrait","doit","donc","dos","debut","elle","elles","en","encore","essai","est","et","eu","fait","faites","fois","font","hors","ici","il","ils","je","juste","le","les","leur","la","ma","maintenant","mais","mes","mien","moins","mon","mot","meme","ni","nommes","notre","nous","ou","par","parce","pas","peut","peu","plupart","pour","pourquoi","quand","que","quel","quelle","quelles","quels","qui","sa","sans","ses","seulement","si","sien","son","sont","sous","soyez","sujet","sur","ta","tandis","tellement","tels","tes","ton","tous","tout","trop","tres","tu","voient","vont","votre","vous","vu","ca","etaient","etat","etions","ete","etre"];var filter_stemmer=function filterStemmer(tokens,language){var stemmer=get_stemmer(language);return tokens.map((function(token){return stemmer(token)}))};var filter_length=function filterLength(tokens){var min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return tokens.filter((function(token){return token.length>=min}))};function defaultTokenizeIt(string){return[prepare_string_indexation(string)]}function tokensToArray(tokenized){return Object.entries(tokenized).reduce((function(a,_ref){var _ref2=Object(slicedToArray.a)(_ref,2),k=_ref2[0],values=_ref2[1];return k.startsWith("pattern")?[].concat(Object(toConsumableArray.a)(a),"string"==typeof values?[values]:Object(toConsumableArray.a)(values)):a}),[])}function filterStopWords(tokens){var stops=arguments.length>1&&void 0!==arguments[1]?arguments[1]:stop_words,mapSW=stops.reduce((function(a,w){return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},w,void 0))}),{});return tokens.reduce((function(a,t){return t in mapSW?a:[].concat(Object(toConsumableArray.a)(a),[t])}),[])}var create_tokenizer=function createEntityTokenizer(fields){var tokenizer=function createTokenizer(){var fields=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],FIELDS_TOKENIZER_MAP=fields.reduce((function(a,f){var name=f.name,_f$rules=f.rules,rules=void 0===_f$rules?[]:_f$rules,min=f.min,_f$language=f.language,language=void 0===_f$language?"French":_f$language,stopWords=f.stopWords;if("soft"===rules)return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},name,soft_tokenizer));if(rules.length){var tokenRules=rules.reduce((function(a,pattern,index){return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},"pattern".concat(name).concat(index),pattern))}),{});return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},name,(function(string){var what=src_default()().input(string).tokens(tokenRules).resolve();return filterStopWords(filter_stemmer(filter_length(tokensToArray(what),min),language),stopWords)})))}return Object(objectSpread2.a)(Object(objectSpread2.a)({},a),{},Object(defineProperty.a)({},name,defaultTokenizeIt))}),{});return function(field,entity){var name=field.name,tokenizeIt=FIELDS_TOKENIZER_MAP[name],value="".concat(entity[name]);return tokenizeIt(remove_accents_default()("".concat(value)).toLowerCase())}}(fields);return function(entity){return fields.reduce((function(a,field){return[].concat(Object(toConsumableArray.a)(a),Object(toConsumableArray.a)(tokenizer(field,entity)))}),[])}}},248:function(module,__webpack_exports__,__webpack_require__){"use strict";var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24);function _fetchCOG(){return(_fetchCOG=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee(){var response,cog;return C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch("/communes-2019.json");case 2:return response=_context.sent,_context.next=5,response.json();case 5:return cog=_context.sent,_context.abrupt("return",cog.map((function(commune,i){var com=commune.com;return Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({},commune),{},{id:"".concat(com,"-").concat(i)})})));case 7:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}__webpack_exports__.a=function fetchCOG(){return _fetchCOG.apply(this,arguments)}},249:function(module,__webpack_exports__,__webpack_require__){"use strict";var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24);function _prout(){return(_prout=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee(){var response,naf;return C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch("/naf-rev2.json");case 2:return response=_context.sent,_context.next=5,response.json();case 5:return naf=_context.sent,_context.abrupt("return",Object.values(naf).map((function(rubrique){var code=rubrique.code;return Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({},rubrique),{},{id:code})})));case 7:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}__webpack_exports__.a=function prout(){return _prout.apply(this,arguments)}},27:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",(function(){return open_db})),__webpack_require__.d(__webpack_exports__,"g",(function(){return open_or_create_db})),__webpack_require__.d(__webpack_exports__,"e",(function(){return idb_bulk_insert})),__webpack_require__.d(__webpack_exports__,"a",(function(){return BULK_INSERT_MESSAGES})),__webpack_require__.d(__webpack_exports__,"c",(function(){return clear_store})),__webpack_require__.d(__webpack_exports__,"b",(function(){return constantes_namespaceObject})),__webpack_require__.d(__webpack_exports__,"d",(function(){return get_entity}));var constantes_namespaceObject={};__webpack_require__.r(constantes_namespaceObject),__webpack_require__.d(constantes_namespaceObject,"STORE_DATA_NAME",(function(){return STORE_DATA_NAME})),__webpack_require__.d(constantes_namespaceObject,"STORE_INFO_NAME",(function(){return STORE_INFO_NAME})),__webpack_require__.d(constantes_namespaceObject,"STORE_INDEX_NAME",(function(){return STORE_INDEX_NAME})),__webpack_require__.d(constantes_namespaceObject,"STORE_INDEX_PATH",(function(){return STORE_INDEX_PATH})),__webpack_require__.d(constantes_namespaceObject,"MAX_STRING",(function(){return MAX_STRING})),__webpack_require__.d(constantes_namespaceObject,"SEARCH_TYPES",(function(){return SEARCH_TYPES})),__webpack_require__.d(constantes_namespaceObject,"default",(function(){return constantes}));var STORE_DATA_NAME="store/entities",STORE_INFO_NAME="store/info",STORE_INDEX_NAME="store/entities/index",STORE_INDEX_PATH="searching",MAX_STRING=String.fromCharCode(65535),SEARCH_TYPES={prefix:"search/prefix",tokens:"search/tokens"},constantes={STORE_DATA_NAME:STORE_DATA_NAME,STORE_INDEX_NAME:STORE_INDEX_NAME,STORE_INDEX_PATH:STORE_INDEX_PATH,MAX_STRING:MAX_STRING,SEARCH_TYPES:SEARCH_TYPES,STORE_INFO_NAME:STORE_INFO_NAME};var IDB_REF=function getIDB(){return indexedDB}();var open_db=function openStorage(name){var version=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(resolve,reject){IDB_REF||reject("indexedDb not supported !");var db,request=IDB_REF.open(name,version),doIt=!0;request.onupgradeneeded=function(e){doIt=!1,e.target.transaction.abort(),reject("fail")},request.onsuccess=function(){db=request.result,doIt&&resolve(db)},request.onerror=function(e){reject(e)}}))};var open_or_create_db_IDB_REF=function open_or_create_db_getIDB(){return indexedDB}();var open_or_create_db=function open_or_create_db_openStorage(name){var version=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(resolve,reject){open_or_create_db_IDB_REF||reject("indexedDb not supported !");var db,request=open_or_create_db_IDB_REF.open(name,version),doIt=!0;request.onupgradeneeded=function(e){doIt=!1;var store=(db=e.target.result).createObjectStore(constantes.STORE_DATA_NAME,{keyPath:"id"});db.createObjectStore(constantes.STORE_INFO_NAME,{keyPath:"name"}),store.createIndex(constantes.STORE_INDEX_NAME,"tokens",{multiEntry:!0}),e.target.transaction.oncomplete=function(){resolve(db)}},request.onsuccess=function(){doIt&&resolve(request.result)},request.onerror=function(e){reject(e)}}))},objectSpread2=__webpack_require__(6),toConsumableArray=__webpack_require__(46),toArray=__webpack_require__(125),BULK_INSERT_MESSAGES={bulkInsertComplete:{type:"bulk-insert/complete"},bulkInsertFinished:{type:"bulk-insert/finished"},bulkInsertError:{type:"bulk-insert/error"}},idb_bulk_insert_pushTask=function pushTask(store,transaction){return function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],_ref2=Object(toArray.a)(_ref),first=_ref2[0],rest=_ref2.slice(1);if(first){var request=store.add(first);request.onsuccess=function(){rest.length&&pushTask(store,transaction)(rest)},request.onerror=function(e){throw e}}}};function split(entities){var limit=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return entities.reduce((function(_ref3,n,i){var _ref4=Object(toArray.a)(_ref3),f=_ref4[0],r=_ref4.slice(1);return(i+1)%limit==0?[[n],f].concat(Object(toConsumableArray.a)(r)):[[n].concat(Object(toConsumableArray.a)(f))].concat(Object(toConsumableArray.a)(r))}),[[]])}var idb_bulk_insert_bulkPush=function bulkPush(db,name,hook,resolve,reject,max){return function(lot){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,treated=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_lot=Object(toArray.a)(lot),first=_lot[0],rest=_lot.slice(1);try{if(first){var transaction=db.transaction(name,"readwrite"),store=transaction.objectStore(name);idb_bulk_insert_pushTask(store,transaction)(first),transaction.oncomplete=function(){var nextTreated=treated+first.length;hook({message:Object(objectSpread2.a)(Object(objectSpread2.a)({},BULK_INSERT_MESSAGES.bulkInsertComplete),{},{nb:first.length,treated:nextTreated,step:i,max:max,percent:Math.round(nextTreated/max*100)})}),bulkPush(db,name,hook,resolve,reject,max)(rest,i+1,nextTreated)},transaction.onerror=function(e){hook({message:BULK_INSERT_MESSAGES.bulkInsertError,error:e}),reject(e)}}else hook({message:BULK_INSERT_MESSAGES.bulkInsertFinished}),resolve("success")}catch(e){hook({message:BULK_INSERT_MESSAGES.bulkInsertError}),reject(e)}}};var idb_bulk_insert=function bulkInsert(db,store){var hook=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return null};return function(){var entities=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],lots=split(entities,300);return new Promise((function(resolve,reject){try{idb_bulk_insert_bulkPush(db,store,hook,resolve,reject,entities.length)(lots)}catch(e){reject(e)}}))}};var clear_store=function clearStore(db,name){new Promise((function(resolve,reject){try{var transaction=db.transaction(name,"readwrite");transaction.oncomplete=function(){resolve(!0)},transaction.objectStore(name).clear()}catch(e){reject(e)}}))};var get_entity=function get(db,storeName,id){return new Promise((function(resolve,reject){var transaction=db.transaction(storeName,"readwrite"),request=transaction.objectStore(storeName).get(id);transaction.onerror=function(){reject(transaction.error)},request.onsuccess=function(){resolve(request.result)}}))}},33:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",(function(){return storeCog})),__webpack_require__.d(__webpack_exports__,"g",(function(){return storeNaf})),__webpack_require__.d(__webpack_exports__,"e",(function(){return server_mock})),__webpack_require__.d(__webpack_exports__,"a",(function(){return loader})),__webpack_require__.d(__webpack_exports__,"c",(function(){return option_cog_renderer})),__webpack_require__.d(__webpack_exports__,"d",(function(){return option_naf_renderer})),__webpack_require__.d(__webpack_exports__,"b",(function(){return lorem_paragraphe}));__webpack_require__(46);var toArray=__webpack_require__(125);var storeCog={name:"cog",fields:[{name:"libelle",rules:"soft"},{name:"nccenr",rules:"soft"},{name:"com",rules:"soft"}],queryParser:{type:"soft"},version:"1",display:"libelle"},storeNaf={name:"naf-rev2",fields:[{name:"libelle",rules:[/[\w]+/],language:"French",min:3},{name:"code"}],queryParser:{type:"tokenized",params:{language:"French",pattern:/[\w.]+/}},version:"1",display:"libelle"},slicedToArray=__webpack_require__(20),defineProperty=__webpack_require__(65),objectSpread2=__webpack_require__(6),rest_deps=__webpack_require__(102),object_sizeof=__webpack_require__(487),object_sizeof_default=__webpack_require__.n(object_sizeof);function parserSearch(search){return search?function extractParams(_ref){var _ref2=Object(toArray.a)(_ref),param=_ref2[0],value=_ref2[1],rest=_ref2.slice(2);return param&&value?Object(objectSpread2.a)(Object(defineProperty.a)({},param,value),extractParams(rest)):{}}(search.match(/[\w]+/g)):{}}function makeLink(path,params){var method=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",href=Object.entries(params).reduce((function(a,_ref3,i){var _ref4=Object(slicedToArray.a)(_ref3,2),param=_ref4[0],value=_ref4[1];return 0===i?"".concat(a,"?").concat(param,"=").concat(value):"".concat(a,"&").concat(param,"=").concat(value)}),"".concat(path));return{href:href,method:method}}function createResolver(path){return function(req,res,ctx,entities){var _parserSearch=parserSearch(req.url.search),page=_parserSearch.page,size=_parserSearch.size;if(page&&size){var responsePage=function createPageResponse(entities,path,page,size){var start=Math.min((page-1)*size,entities.length-1),length=Math.min(size,entities.length-start),data=entities.slice(start,start+length),max=Math.ceil(entities.length/size),percent=(start+length)/entities.length*100,previous=page>0?makeLink(path,{size:size,page:page-1}):void 0;return{data:data,pagination:{length:length,page:page,max:max,percent:percent},links:{next:page<=max?makeLink(path,{size:size,page:page+1}):void 0,previous:previous}}}(entities,path,parseInt(page),parseInt(size)),max=responsePage.pagination.max;return res(ctx.status(206),ctx.set("Cache-Control","public"),ctx.set("Content-Range","page ".concat(page,"/").concat(max)),ctx.set("Content-length",object_sizeof_default()(responsePage)),ctx.json(responsePage))}return res(ctx.status(200),ctx.json(function createRootResponse(path){var size=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,first=makeLink(path,{size:size,page:1});return{links:{first:first}}}(path)))}}var server_mock=function mock(path,fetchData){var data;fetchData().then((function(d){data=d}));var communesResolver=createResolver(path);return rest_deps.e.get(path,(function(req,res,ctx){return data?communesResolver(req,res,ctx,data):res(ctx.status(404),ctx.json({error:"not ready yet!"}))}))},regenerator=__webpack_require__(10),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(24),react=__webpack_require__(0),store_index=__webpack_require__(91);function browsePages(_x){return _browsePages.apply(this,arguments)}function _browsePages(){return(_browsePages=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee2(request){var todo,params,response,status,body,links,data,pagination,first,next,href,_href,_args2=arguments;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return todo=_args2.length>1&&void 0!==_args2[1]?_args2[1]:Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(){return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",null);case 1:case"end":return _context.stop()}}),_callee)}))),params=_args2.length>2?_args2[2]:void 0,_context2.next=4,fetch(request);case 4:if(response=_context2.sent,200!==(status=response.status)&&206!==status){_context2.next=30;break}return _context2.next=9,response.json();case 9:if(body=_context2.sent,links=body.links,data=body.data,pagination=body.pagination,first=links.first,next=links.next,!first){_context2.next=18;break}return href=first.href,_context2.next=16,browsePages(href,todo,params);case 16:_context2.next=28;break;case 18:if(!next){_context2.next=26;break}return _href=next.href,_context2.next=22,todo(data,pagination,params);case 22:return _context2.next=24,browsePages(_href,todo,params);case 24:_context2.next=28;break;case 26:return _context2.next=28,todo("Finished",params);case 28:_context2.next=36;break;case 30:if(404!==status){_context2.next=35;break}return _context2.next=33,todo("Finished",params);case 33:_context2.next=36;break;case 35:throw new Error("Error during browse ".concat(request));case 36:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}var browse_pages=browsePages,Box=__webpack_require__(922),CircularProgress=__webpack_require__(919),Typography=__webpack_require__(920),jsx_runtime=__webpack_require__(5);function Progress(_ref){var display=_ref.display,_ref$value=_ref.value,value=void 0===_ref$value?0:_ref$value;return display?Object(jsx_runtime.jsxs)(Box.a,{position:"relative",display:"inline-flex",children:[Object(jsx_runtime.jsx)(CircularProgress.a,{variant:"determinate",value:value,color:"secondary"}),Object(jsx_runtime.jsx)(Box.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(jsx_runtime.jsx)(Typography.a,{variant:"caption",component:"div",color:"textSecondary",children:"".concat(Math.round(value),"%")})})]}):null}Progress.__docgenInfo={description:"",methods:[],displayName:"Progress",props:{value:{defaultValue:{value:"0",computed:!1},required:!1}}};var components_progress=Progress;function Loader(_ref){var start=_ref.start,db=_ref.db,store=_ref.store,_useState=Object(react.useState)(0),_useState2=Object(slicedToArray.a)(_useState,2),progress=_useState2[0],setProgress=_useState2[1],_useState3=Object(react.useState)(void 0),_useState4=Object(slicedToArray.a)(_useState3,2),abort=_useState4[0],setAbort=_useState4[1],name=store.name,indexPage=Object(react.useCallback)(function(){var _ref2=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(results,pagination,store){var percent,_name,fields,_createAppendTask,_createAppendTask2,_start,_abort;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!Array.isArray(results)){_context.next=7;break}return percent=pagination.percent,_name=store.name,fields=store.fields,_createAppendTask=Object(store_index.b)(_name,"1",fields,(function(_ref3){_ref3.message;return null})),_createAppendTask2=Object(slicedToArray.a)(_createAppendTask,2),_start=_createAppendTask2[0],_abort=_createAppendTask2[1],setAbort(_abort),_context.next=7,_start(results,(function(){setProgress(percent),setAbort(void 0)}));case 7:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2,_x3){return _ref2.apply(this,arguments)}}(),[]);return Object(react.useEffect)((function(){function _go(){return(_go=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee2(){var href;return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,!start){_context2.next=6;break}return Object(store_index.a)(db),href=store.href,_context2.next=6,browse_pages(href,indexPage,store);case 6:_context2.next=11;break;case 8:_context2.prev=8,_context2.t0=_context2.catch(0),console.log(_context2.t0);case 11:case"end":return _context2.stop()}}),_callee2,null,[[0,8]])})))).apply(this,arguments)}!function go(){return _go.apply(this,arguments)}()}),[start,store,db,indexPage]),Object(react.useEffect)((function(){return function(){abort&&abort()}}),[abort]),Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("span",{style:{position:"absolute",top:0},children:name}),Object(jsx_runtime.jsx)(components_progress,{value:progress,display:!0})]})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\common-tools\\components\\progress.js"]={name:"Progress",docgenInfo:Progress.__docgenInfo,path:"src\\stories\\common-tools\\components\\progress.js"}),Loader.__docgenInfo={description:"",methods:[],displayName:"Loader"};var loader=Loader;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\common-tools\\components\\loader.js"]={name:"Loader",docgenInfo:Loader.__docgenInfo,path:"src\\stories\\common-tools\\components\\loader.js"});var classnames=__webpack_require__(56),classnames_default=__webpack_require__.n(classnames);function OptionCogRenderer(_ref){var option=_ref.option,selected=_ref.selected,libelle=option.libelle,com=option.com;return Object(jsx_runtime.jsxs)("div",{className:classnames_default()("cog-option",{selected:selected}),children:[Object(jsx_runtime.jsx)("span",{className:"code",children:com}),Object(jsx_runtime.jsx)("span",{className:"libelle",children:libelle})]})}OptionCogRenderer.__docgenInfo={description:"",methods:[],displayName:"OptionCogRenderer"};var option_cog_renderer=OptionCogRenderer;function OptionNafRenderer(_ref){var option=_ref.option,selected=_ref.selected,libelle=option.libelle,code=option.code,niveau=option.niveau;return Object(jsx_runtime.jsxs)("div",{className:classnames_default()("naf-option",{selected:selected}),children:[Object(jsx_runtime.jsx)("span",{className:classnames_default()("code",niveau),title:"".concat(niveau," ").concat(code),children:code}),Object(jsx_runtime.jsx)("span",{className:"libelle",children:libelle})]})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\common-tools\\components\\option-cog-renderer.js"]={name:"OptionCogRenderer",docgenInfo:OptionCogRenderer.__docgenInfo,path:"src\\stories\\common-tools\\components\\option-cog-renderer.js"}),OptionNafRenderer.__docgenInfo={description:"",methods:[],displayName:"OptionNafRenderer"};var option_naf_renderer=OptionNafRenderer;function LoremParagraph(){return Object(jsx_runtime.jsx)("p",{style:{display:"block",width:400},children:"Vestibulum lacinia tempor lacus. Donec dictum ut odio at efficitur. Suspendisse ligula ante, efficitur ut arcu quis, varius convallis dui. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Nunc rutrum purus elementum est semper, tincidunt tincidunt sapien aliquet. Integer dictum tellus et elit aliquam placerat."})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\common-tools\\components\\option-naf-renderer.js"]={name:"OptionNafRenderer",docgenInfo:OptionNafRenderer.__docgenInfo,path:"src\\stories\\common-tools\\components\\option-naf-renderer.js"}),LoremParagraph.__docgenInfo={description:"",methods:[],displayName:"LoremParagraph"};var lorem_paragraphe=LoremParagraph;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\common-tools\\components\\lorem-paragraphe.js"]={name:"LoremParagraph",docgenInfo:LoremParagraph.__docgenInfo,path:"src\\stories\\common-tools\\components\\lorem-paragraphe.js"})},513:function(module,exports,__webpack_require__){__webpack_require__(514),__webpack_require__(668),__webpack_require__(669),__webpack_require__(892),__webpack_require__(893),__webpack_require__(897),__webpack_require__(898),__webpack_require__(896),__webpack_require__(895),__webpack_require__(899),__webpack_require__(900),module.exports=__webpack_require__(868)},580:function(module,exports){},669:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(227)},868:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(227).configure)([__webpack_require__(869),__webpack_require__(870)],module,!1)}).call(this,__webpack_require__(221)(module))},869:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=869},870:function(module,exports,__webpack_require__){var map={"./stories/all-in-one.stories.js":871,"./stories/create-store-cog.stories.js":888,"./stories/create-store-naf.stories.js":889,"./stories/suggester.stories.js":890};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=870},871:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"AllInOne",(function(){return AllInOne}));var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),_store_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(91),_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(325),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(162),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_7__),_suggester_idb__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(126),_common_tools__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(33),_common_tools_fetch_cog__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(248),_common_tools_fetch_naf_rev2__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(249),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__=(__webpack_require__(884),__webpack_require__(5)),STORES=[Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.a)({},_common_tools__WEBPACK_IMPORTED_MODULE_9__.f),{},{href:"/cog/communes?page=1&size=1000"}),Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.a)({},_common_tools__WEBPACK_IMPORTED_MODULE_9__.g),{},{href:"/naf-rev2?page=1&size=500"})],storeCogName=_common_tools__WEBPACK_IMPORTED_MODULE_9__.f.name,storeNafName=_common_tools__WEBPACK_IMPORTED_MODULE_9__.g.name;function CustomLabelCog(_ref2){var option=_ref2.option,search=_ref2.search,placeholder=_ref2.placeholder;if(option){var com=option.com,libelle=option.libelle;return"".concat(libelle," - ").concat(com)}return search||Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)("span",{className:"placeholder",children:placeholder})}var AllInOne=function AllInOne(){var _useState3=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(!0),_useState4=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState3,2),disabled=_useState4[0],setDisabled=_useState4[1],_useState5=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(!1),_useState6=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState5,2),start=_useState6[0],setStart=_useState6[1],idbx=function useCreateStores(){var stores=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],_useState=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(void 0),_useState2=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_useState,2),dbs=_useState2[0],setDbs=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){function _init(){return(_init=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee2(){var load;return C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return load=stores.map(function(){var _ref=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee(store){return C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(_store_index__WEBPACK_IMPORTED_MODULE_5__.c)(store,"1");case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()),_context2.t0=setDbs,_context2.next=4,Promise.all(load);case 4:_context2.t1=_context2.sent,(0,_context2.t0)(_context2.t1);case 6:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}!function init(){return _init.apply(this,arguments)}()}),[stores]),dbs}(STORES);return Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){idbx&&setDisabled(!1)}),[idbx]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)(_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_6__.a,{disabled:disabled,color:"primary","aria-label":"add",onClick:function onClick(){return setStart(!0)},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_7___default.a,{})}),disabled?null:STORES.map((function(store,index){var name=store.name,db=idbx[index];return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)(_common_tools__WEBPACK_IMPORTED_MODULE_9__.a,{start:start,db:db,store:store},name)})),disabled?"Store en cours d'ouverture, ou de cration...":Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)("div",{children:"COG :"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)("label",{id:"label-suggester-cog",htmlFor:"suggest-communes",children:"Label for Suggester COG"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)(_suggester_idb__WEBPACK_IMPORTED_MODULE_8__.a,{id:"suggest-communes",labelledBy:"label-suggester-cog",className:"custom-theme",storeName:storeCogName,version:"1",optionRenderer:_common_tools__WEBPACK_IMPORTED_MODULE_9__.c,labelRenderer:CustomLabelCog,onChange:function onChange(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return console.log(args)},onSelect:function onSelect(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return console.log(args)}}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)("div",{children:"NAF-REV2 :"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_13__.jsx)(_suggester_idb__WEBPACK_IMPORTED_MODULE_8__.a,{className:"custom-theme",storeName:storeNafName,version:"1",optionRenderer:_common_tools__WEBPACK_IMPORTED_MODULE_9__.d,onChange:function onChange(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return console.log(args)},onSelect:function onSelect(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return console.log(args)}})]})]})},story={title:"suggester/all-in-one",component:_suggester_idb__WEBPACK_IMPORTED_MODULE_8__.a,parameters:{msw:[Object(_common_tools__WEBPACK_IMPORTED_MODULE_9__.e)("/cog/communes",_common_tools_fetch_cog__WEBPACK_IMPORTED_MODULE_10__.a),Object(_common_tools__WEBPACK_IMPORTED_MODULE_9__.e)("/naf-rev2",_common_tools_fetch_naf_rev2__WEBPACK_IMPORTED_MODULE_11__.a)]}};__webpack_exports__.default=story,AllInOne.parameters=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.a)({storySource:{source:'function AllInOne() {\r\n\tconst [disabled, setDisabled] = useState(true);\r\n\tconst [start, setStart] = useState(false);\r\n\tconst idbx = useCreateStores(STORES);\r\n\r\n\tuseEffect(\r\n\t\tfunction () {\r\n\t\t\tif (idbx) {\r\n\t\t\t\tsetDisabled(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[idbx]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Fab\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tcolor="primary"\r\n\t\t\t\taria-label="add"\r\n\t\t\t\tonClick={() => setStart(true)}\r\n\t\t\t>\r\n\t\t\t\t<Loop />\r\n\t\t\t</Fab>\r\n\t\t\t{!disabled\r\n\t\t\t\t? STORES.map(function (store, index) {\r\n\t\t\t\t\t\tconst { name } = store;\r\n\t\t\t\t\t\tconst db = idbx[index];\r\n\t\t\t\t\t\treturn <Loader key={name} start={start} db={db} store={store} />;\r\n\t\t\t\t  })\r\n\t\t\t\t: null}\r\n\t\t\t{!disabled ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div>COG :</div>\r\n\t\t\t\t\t<label id="label-suggester-cog" htmlFor="suggest-communes">\r\n\t\t\t\t\t\tLabel for Suggester COG\r\n\t\t\t\t\t</label>\r\n\t\t\t\t\t<Suggester\r\n\t\t\t\t\t\tid="suggest-communes"\r\n\t\t\t\t\t\tlabelledBy="label-suggester-cog"\r\n\t\t\t\t\t\tclassName="custom-theme"\r\n\t\t\t\t\t\tstoreName={storeCogName}\r\n\t\t\t\t\t\tversion="1"\r\n\t\t\t\t\t\toptionRenderer={OptionCogRenderer}\r\n\t\t\t\t\t\tlabelRenderer={CustomLabelCog}\r\n\t\t\t\t\t\tonChange={(...args) => console.log(args)}\r\n\t\t\t\t\t\tonSelect={(...args) => console.log(args)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div>NAF-REV2 :</div>\r\n\t\t\t\t\t<Suggester\r\n\t\t\t\t\t\tclassName="custom-theme"\r\n\t\t\t\t\t\tstoreName={storeNafName}\r\n\t\t\t\t\t\tversion="1"\r\n\t\t\t\t\t\toptionRenderer={OptionNafRenderer}\r\n\t\t\t\t\t\tonChange={(...args) => console.log(args)}\r\n\t\t\t\t\t\tonSelect={(...args) => console.log(args)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t"Store en cours d\'ouverture, ou de cration..."\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n}'}},AllInOne.parameters),AllInOne.__docgenInfo={description:"",methods:[],displayName:"AllInOne"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\all-in-one.stories.js"]={name:"AllInOne",docgenInfo:AllInOne.__docgenInfo,path:"src\\stories\\all-in-one.stories.js"})},878:function(module,exports,__webpack_require__){},884:function(module,exports,__webpack_require__){},888:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CreateFillStoreCog",(function(){return CreateFillStoreCog}));var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(325),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(162),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4__),_common_tools__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(33),_common_tools_fetch_cog__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(248),_store_index__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(91),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5),name=_common_tools__WEBPACK_IMPORTED_MODULE_5__.f.name,STORE=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({},_common_tools__WEBPACK_IMPORTED_MODULE_5__.f),{},{href:"/cog/communes"}),CreateFillStoreCog=function CreateFillStoreCog(){var _useState=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0),_useState2=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),disabled=_useState2[0],setDisabled=_useState2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),_useState4=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),start=_useState4[0],setStart=_useState4[1],db=Object(_store_index__WEBPACK_IMPORTED_MODULE_7__.d)(STORE,"1");return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){db&&setDisabled(!1)}),[db]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_3__.a,{disabled:disabled,color:"primary","aria-label":"add",onClick:function onClick(){return setStart(!0)},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4___default.a,{})}),start?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_common_tools__WEBPACK_IMPORTED_MODULE_5__.a,{start:start,db:db,store:STORE},name):void 0]})},story={title:"store-index/cog",component:function component(){return null},parameters:{msw:[Object(_common_tools__WEBPACK_IMPORTED_MODULE_5__.e)("/cog/communes",_common_tools_fetch_cog__WEBPACK_IMPORTED_MODULE_6__.a)]}};__webpack_exports__.default=story,CreateFillStoreCog.parameters=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({storySource:{source:'function CreateFillStoreCog() {\r\n\tconst [disabled, setDisabled] = useState(true);\r\n\tconst [start, setStart] = useState(false);\r\n\tconst db = useStoreIndex(STORE, \'1\');\r\n\r\n\tuseEffect(\r\n\t\tfunction () {\r\n\t\t\tif (db) {\r\n\t\t\t\tsetDisabled(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[db]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Fab\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tcolor="primary"\r\n\t\t\t\taria-label="add"\r\n\t\t\t\tonClick={() => setStart(true)}\r\n\t\t\t>\r\n\t\t\t\t<Loop />\r\n\t\t\t</Fab>\r\n\t\t\t{start ? (\r\n\t\t\t\t<Loader key={name} start={start} db={db} store={STORE} />\r\n\t\t\t) : undefined}\r\n\t\t</>\r\n\t);\r\n}'}},CreateFillStoreCog.parameters),CreateFillStoreCog.__docgenInfo={description:"",methods:[],displayName:"CreateFillStoreCog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\create-store-cog.stories.js"]={name:"CreateFillStoreCog",docgenInfo:CreateFillStoreCog.__docgenInfo,path:"src\\stories\\create-store-cog.stories.js"})},889:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CreateFillStoreCog",(function(){return CreateFillStoreCog}));var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(325),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(162),_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4__),_common_tools__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(33),_common_tools_fetch_naf_rev2__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(249),_store_index__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(91),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5),name=_common_tools__WEBPACK_IMPORTED_MODULE_5__.g.name,STORE=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)(Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({},_common_tools__WEBPACK_IMPORTED_MODULE_5__.g),{},{version:"1",href:"/naf-rev2"}),CreateFillStoreCog=function CreateFillStoreCog(){var _useState=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0),_useState2=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),disabled=_useState2[0],setDisabled=_useState2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),_useState4=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),start=_useState4[0],setStart=_useState4[1],db=Object(_store_index__WEBPACK_IMPORTED_MODULE_7__.d)(STORE,"1");return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){db&&setDisabled(!1)}),[db]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_material_ui_core_Fab__WEBPACK_IMPORTED_MODULE_3__.a,{disabled:disabled,color:"primary","aria-label":"add",onClick:function onClick(){return setStart(!0)},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_material_ui_icons_Loop__WEBPACK_IMPORTED_MODULE_4___default.a,{})}),start?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_common_tools__WEBPACK_IMPORTED_MODULE_5__.a,{start:start,db:db,store:STORE},name):void 0]})},story={title:"store-index/naf",component:function component(){return null},parameters:{msw:[Object(_common_tools__WEBPACK_IMPORTED_MODULE_5__.e)("/naf-rev2",_common_tools_fetch_naf_rev2__WEBPACK_IMPORTED_MODULE_6__.a)]}};__webpack_exports__.default=story,CreateFillStoreCog.parameters=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.a)({storySource:{source:'function CreateFillStoreCog() {\r\n\tconst [disabled, setDisabled] = useState(true);\r\n\tconst [start, setStart] = useState(false);\r\n\tconst db = useStoreIndex(STORE, \'1\');\r\n\r\n\tuseEffect(\r\n\t\tfunction () {\r\n\t\t\tif (db) {\r\n\t\t\t\tsetDisabled(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[db]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Fab\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tcolor="primary"\r\n\t\t\t\taria-label="add"\r\n\t\t\t\tonClick={() => setStart(true)}\r\n\t\t\t>\r\n\t\t\t\t<Loop />\r\n\t\t\t</Fab>\r\n\t\t\t{start ? (\r\n\t\t\t\t<Loader key={name} start={start} db={db} store={STORE} />\r\n\t\t\t) : undefined}\r\n\t\t</>\r\n\t);\r\n}'}},CreateFillStoreCog.parameters),CreateFillStoreCog.__docgenInfo={description:"",methods:[],displayName:"CreateFillStoreCog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\create-store-naf.stories.js"]={name:"CreateFillStoreCog",docgenInfo:CreateFillStoreCog.__docgenInfo,path:"src\\stories\\create-store-naf.stories.js"})},890:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"DefaultSuggesterWithNafRev2",(function(){return DefaultSuggesterWithNafRev2})),__webpack_require__.d(__webpack_exports__,"DefaultSuggesterWithCOG",(function(){return DefaultSuggesterWithCOG}));var C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_suggester_idb__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(126)),_common_tools__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(33),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(891),__webpack_require__(5)),DefaultSuggesterWithNafRev2=function DefaultSuggesterWithNafRev2(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_suggester_idb__WEBPACK_IMPORTED_MODULE_2__.a,{storeName:"naf-rev2",version:"1",optionRenderer:_common_tools__WEBPACK_IMPORTED_MODULE_3__.d}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_common_tools__WEBPACK_IMPORTED_MODULE_3__.b,{})]})},DefaultSuggesterWithCOG=function DefaultSuggesterWithCOG(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_suggester_idb__WEBPACK_IMPORTED_MODULE_2__.a,{storeName:"cog",version:"1",optionRenderer:_common_tools__WEBPACK_IMPORTED_MODULE_3__.c}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_common_tools__WEBPACK_IMPORTED_MODULE_3__.b,{})]})},story={title:"Suggester",component:_suggester_idb__WEBPACK_IMPORTED_MODULE_2__.a};__webpack_exports__.default=story,DefaultSuggesterWithNafRev2.parameters=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({storySource:{source:'function DefaultSuggesterWithNafRev2() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Suggester\r\n\t\t\t\tstoreName="naf-rev2"\r\n\t\t\t\tversion="1"\r\n\t\t\t\toptionRenderer={OptionNafRenderer}\r\n\t\t\t/>\r\n\t\t\t<LoremParagraph />\r\n\t\t</>\r\n\t);\r\n}'}},DefaultSuggesterWithNafRev2.parameters),DefaultSuggesterWithCOG.parameters=Object(C_workspace_metallica_suggester_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({storySource:{source:'function DefaultSuggesterWithCOG() {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Suggester\r\n\t\t\t\tstoreName="cog"\r\n\t\t\t\tversion="1"\r\n\t\t\t\toptionRenderer={OptionCogRenderer}\r\n\t\t\t/>\r\n\t\t\t<LoremParagraph />\r\n\t\t</>\r\n\t);\r\n}'}},DefaultSuggesterWithCOG.parameters),DefaultSuggesterWithNafRev2.__docgenInfo={description:"",methods:[],displayName:"DefaultSuggesterWithNafRev2"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\suggester.stories.js"]={name:"DefaultSuggesterWithNafRev2",docgenInfo:DefaultSuggesterWithNafRev2.__docgenInfo,path:"src\\stories\\suggester.stories.js"}),DefaultSuggesterWithCOG.__docgenInfo={description:"",methods:[],displayName:"DefaultSuggesterWithCOG"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\stories\\suggester.stories.js"]={name:"DefaultSuggesterWithCOG",docgenInfo:DefaultSuggesterWithCOG.__docgenInfo,path:"src\\stories\\suggester.stories.js"})},891:function(module,exports,__webpack_require__){},900:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters}));var client_api=__webpack_require__(924),esm=__webpack_require__(8),client=__webpack_require__(227),dist=__webpack_require__(324);Object(dist.initializeWorker)(),Object(client.addDecorator)(dist.mswDecorator);var parameters={actions:{argTypesRegex:"^on[A-Z].*"}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.b)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.c)(loader,!1)}));case"parameters":return Object(client_api.d)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.d)(v,!1);default:return console.log(key+" was not supported :( !")}}))},91:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return create_append_task})),__webpack_require__.d(__webpack_exports__,"c",(function(){return create_create})),__webpack_require__.d(__webpack_exports__,"a",(function(){return clear_data})),__webpack_require__.d(__webpack_exports__,"d",(function(){return use_store_index}));var regenerator=__webpack_require__(10),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(24),commons_idb=__webpack_require__(27);var update_store_info=function update(db,info){return new Promise((function(resolve,reject){try{var request=db.transaction(commons_idb.b.STORE_INFO_NAME,"readwrite").objectStore(commons_idb.b.STORE_INFO_NAME).add(info);request.onsuccess=function(){resolve("success")},request.onerror=function(e){reject(e)}}catch(e){reject(e)}}))};function _create(){return(_create=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(store,idbVersion){var name,queryParser,display,version,db;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return name=store.name,queryParser=store.queryParser,display=store.display,version=store.version,_context.prev=1,_context.next=4,Object(commons_idb.g)(name,idbVersion);case 4:return db=_context.sent,_context.next=7,Object(commons_idb.c)(db,commons_idb.b.STORE_INFO_NAME);case 7:return _context.next=9,update_store_info(db,{queryParser:queryParser,name:name,version:version,display:display});case 9:return _context.abrupt("return",db);case 12:throw _context.prev=12,_context.t0=_context.catch(1),_context.t0;case 15:case"end":return _context.stop()}}),_callee,null,[[1,12]])})))).apply(this,arguments)}var create_create=function create(_x,_x2){return _create.apply(this,arguments)};function Worker_fn(){return new Worker(__webpack_require__.p+"append.worker.6b97aab7.iframe.bundle.worker.js")}var objectSpread2=__webpack_require__(6),store_messages=Object(objectSpread2.a)(Object(objectSpread2.a)({},commons_idb.a),{},{startCreateIndex:{type:"fill-store/start-create-index"},indexBatch:{type:"fill-store/index-batch",max:void 0,done:void 0,percent:void 0},createIndexDone:{type:"fill-store/create-index-done"},storeClear:{type:"fill-store/clear-store"},startInsertBatch:{type:"fill-store/start-insert-bacth"},insertBatchDone:{type:"fill-store/insert-done"},done:{type:"fill-store/done"},error:{type:"fill-store/error"}}),commons_tokenizer=__webpack_require__(141);function prepareEntities(fields,entities,log){var tokenizer=Object(commons_tokenizer.a)(fields),done=0,max=entities.length;return entities.map((function(suggestion){var id=suggestion.id;if(id){var tokens=tokenizer(suggestion);return++done%1e3!=0&&done!==max||log({message:Object(objectSpread2.a)(Object(objectSpread2.a)({},store_messages.indexBatch),{},{max:max,done:done,percent:done/max*100})}),{id:id,suggestion:suggestion,tokens:tokens}}throw new Error("Missing id on entity.")}),[])}function _append(){return(_append=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(name,version,fields,entities){var log,prepared,db,_args=arguments;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return log=_args.length>4&&void 0!==_args[4]?_args[4]:function(){return null},_context.prev=1,prepared=prepareEntities(fields,entities,log),_context.next=5,Object(commons_idb.f)(name,version);case 5:return db=_context.sent,log({message:store_messages.startInsertBatch}),_context.next=9,Object(commons_idb.e)(db,commons_idb.b.STORE_DATA_NAME,(function(args){var message=args.message;log({message:message})}))(prepared);case 9:return log({message:store_messages.insertBatchDone}),log({message:store_messages.done}),_context.abrupt("return","success");case 14:_context.prev=14,_context.t0=_context.catch(1),log({message:"une erreur est survenue"});case 17:case"end":return _context.stop()}}),_callee,null,[[1,14]])})))).apply(this,arguments)}var append_append=function append(_x,_x2,_x3,_x4){return _append.apply(this,arguments)};function isWorkerCompatible(){return!!window.Worker}function withoutWorker(name,version,fields,log){function _launch(){return(_launch=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(entities){var result;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,append_append(name,version,fields,entities,log);case 2:return result=_context.sent,_context.abrupt("return",Promise.resolve(result));case 4:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}return[function launch(_x){return _launch.apply(this,arguments)},function terminate(){}]}function withWorker(name,version,fields,log){var worker=new Worker_fn,start=!1,stop=!1;return[function launch(entities){var post=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};return new Promise((function(resolve){start=!0,worker.postMessage({name:name,version:version,fields:fields,entities:entities}),worker.addEventListener("message",(function(e){var data=e.data;"success"===data?(stop||post(),resolve(data)):log(data)}))}))},function terminate(){start&&(stop=!0,worker.terminate())}]}var create_append_task=function task(name,version,fields){var log=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return null};return isWorkerCompatible()?withWorker(name,version,fields,log):withoutWorker(name,version,fields,log)};var clear_data=function clear(db){Object(commons_idb.c)(db,commons_idb.b.STORE_DATA_NAME)},slicedToArray=__webpack_require__(20),react=__webpack_require__(0);var use_store_index=function useStoreIndex(store,idbVersion){var _useState=Object(react.useState)(void 0),_useState2=Object(slicedToArray.a)(_useState,2),db=_useState2[0],setDb=_useState2[1];return Object(react.useEffect)((function(){function _init(){return(_init=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(){var _db;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!store||!idbVersion){_context.next=5;break}return _context.next=3,create_create(store,idbVersion);case 3:_db=_context.sent,setDb(_db);case 5:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}!function init(){return _init.apply(this,arguments)}()}),[store,idbVersion]),db}}},[[513,2,3]]]);